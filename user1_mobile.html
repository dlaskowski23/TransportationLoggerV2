<!DOCTYPE html> <html lang="en"> 
    <head> 
        <meta charset="UTF-8" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1" /> 
        <title>Trip Logger</title> 
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"> 
        <style> 
            html { font-size: 18px; -webkit-text-size-adjust: 100%; } 
            @media (max-width: 380px) { html { font-size: 19px; } } 
            body { background-color: #2b2b2b; color: #fff; line-height: 1.5; } 
            .panel { background: #3a3a3a; border-radius: .9rem; padding: 1.1rem; margin-bottom: 1.1rem; } 
            .section-title { font-weight: 700; margin-bottom: .7rem; font-size: 1.1rem; } 
            /* Stack buttons vertically and enlarge touch targets */ 
            .btn-group { display: grid; grid-template-columns: 1fr; gap: .65rem; } 
            .btn-choice { padding: 1.35rem; font-size: 1.35rem; border-radius: .75rem !important; } 
            .btn-choice.active { background: #28a745; color: #fff; } 
            /* Swap button size */ 
            #swap { padding: 1.05rem; font-size: 1.15rem; border-radius: .75rem; } 
            /* Summary + Submit */ 
            .summary { font-size: 1.2rem; margin-bottom: .7rem; } 
            #submitBtn { padding: 1.05rem 1.25rem; font-size: 1.25rem; border-radius: .75rem; width: 100%; } 
            /* Keep submit visible above bottom chrome on phones */ 
            .sticky-submit { position: sticky; bottom: 0; z-index: 1020; padding-bottom: calc(env(safe-area-inset-bottom, 0) + .3rem); } 
            /* Bigger toast text/width on phones (use your existing toast container) */ 
            .toast { font-size: 1.1rem; min-width: calc(100vw - 2rem); } </style>
    </head> 
    
    <body> 
        <div class="container py-3"> 
            <h1 class="h4 mb-3">Trip Logger</h1>

            <div class="panel">

                <div class="section-title">From</div>
                <div class="btn-group w-100" role="group" aria-label="From choices">
                    <button class="btn btn-outline-light btn-choice from" data-value="Gillette">Gillette</button>
                    <button class="btn btn-outline-light btn-choice from" data-value="Millington">Millington</button>
                    <button class="btn btn-outline-light btn-choice from" data-value="Central">Central</button>
                </div>
            </div>

            <div class="d-grid my-2">
                <button id="swap" class="btn btn-secondary">Swap From ↔ To</button>
            </div>

            <div class="panel">
                <div class="section-title">To</div>
                <div class="btn-group w-100" role="group" aria-label="To choices">
                    <button class="btn btn-outline-light btn-choice to" data-value="Gillette">Gillette</button>
                    <button class="btn btn-outline-light btn-choice to" data-value="Millington">Millington</button>
                    <button class="btn btn-outline-light btn-choice to" data-value="Central">Central</button>
                </div>
            </div>

            <div class="panel d-flex justify-content-between align-items-center sticky-submit">
                <div class="summary">
                    <span id="summaryText">Pick a route to see miles.</span>
                </div>
                <button id="submitBtn" class="btn btn-primary btn-lg" disabled>Submit</button>
            </div>
        </div> 

            <div class="toast-container position-fixed top-0 start-50 translate-middle-x p-3"> 
                <div class="toast big-toast bg-success text-white" id="submitToast" data-bs-delay="3500" role="status" aria-live="polite" aria-atomic="true"> 
                    <div class="toast-header"> 
                        <strong class="me-auto">Trip Logger</strong> <small class="text-muted">now</small> 
                        <button type="button" class="btn-close btn-close-white ms-2 mb-1" data-bs-dismiss="toast" aria-label="Close"></button> 
                    </div> 
                    <div class="toast-body">Trip logged!</div> 
                </div> 
            </div> 
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script> 
        <script> // Keep in sync with logger.gs 
            const RATE = 0.47; 
            
            const DISTANCE = { 
                Gillette: { Millington: 3.0, Central: 2.1 }, 
                Millington: { Gillette: 3.0, Central: 1.7 }, 
                Central: { Gillette: 2.1, Millington: 1.7 } 
            }; 
            
            let selectedFrom = null; 
            let selectedTo = null; 
            
            function updateActive(selector, value) { 
                document.querySelectorAll(selector).forEach(btn => { btn.classList.toggle('active', btn.dataset.value === value); }); 
            } 
            
            function computeMiles(from, to) { 
                if (!from || !to || from === to) return null; 
                return (DISTANCE[from] && DISTANCE[from][to]) || null; 
            } 
            
            function computeAmount(miles) { 
                if (miles == null) return null; 
                return Math.round(miles * RATE * 100) / 100; 
            } 
            
            function updateSummary() { 
                const miles = computeMiles(selectedFrom, selectedTo); 
                const amount = computeAmount(miles); 
                const textEl = document.getElementById('summaryText'); 
                const submitBtn = document.getElementById('submitBtn'); 
                
                if (!selectedFrom || !selectedTo) { 
                    textEl.textContent = 'Pick a route to see miles.'; 
                    submitBtn.disabled = true; return; 
                } 
                if (selectedFrom === selectedTo) { 
                    textEl.textContent = 'From and To must be different.'; 
                    submitBtn.disabled = true; return; 
                } 
                if (miles == null) { 
                    textEl.textContent = `No distance for ${selectedFrom} → ${selectedTo}.`; 
                    submitBtn.disabled = true; return; 
                } 
                
                textEl.textContent = `${selectedFrom} → ${selectedTo} • ${miles} miles • $${amount.toFixed(2)}`; 
                submitBtn.disabled = false; 
            } 
            
            window.addEventListener('DOMContentLoaded', () => { 
                document.querySelectorAll('.btn-choice.from').forEach(btn => { btn.addEventListener('click', () => { selectedFrom = btn.dataset.value; updateActive('.btn-choice.from', selectedFrom); updateSummary(); }); }); 
                document.querySelectorAll('.btn-choice.to').forEach(btn => { btn.addEventListener('click', () => { selectedTo = btn.dataset.value; updateActive('.btn-choice.to', selectedTo); updateSummary(); }); }); 
                document.getElementById('swap').addEventListener('click', () => { [selectedFrom, selectedTo] = [selectedTo, selectedFrom]; updateActive('.btn-choice.from', selectedFrom); updateActive('.btn-choice.to', selectedTo); updateSummary(); }); 
                document.getElementById('submitBtn').addEventListener('click', () => { const dateStr = new Date().toLocaleDateString('en-US'); google.script.run.withSuccessHandler(function(res) { const body = document.querySelector('#submitToast .toast-body'); 
                
                if (res && res.ok) { const amountStr = (typeof res.amount === 'number') ? res.amount.toFixed(2) : computeAmount(res.miles).toFixed(2); body.textContent = `Trip logged: ${selectedFrom} → ${selectedTo} (${res.miles} miles, $${amountStr}).`; } 
                else { body.textContent = 'Trip not logged. Please try again.'; } new bootstrap.Toast(document.getElementById('submitToast')).show(); }).logTrip('USER1 SHEET', dateStr, selectedFrom, selectedTo); }); 
            }); 
        </script> 
    </body> 
</html>